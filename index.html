<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Native Gap Audit | Expanded Future</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 700px;
            width: 100%;
            padding: 50px 40px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1em;
            color: #718096;
            line-height: 1.6;
        }

        .intro {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: #f7fafc;
            border-radius: 12px;
        }

        .intro p {
            font-size: 1.05em;
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 20px;
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .question-section {
            display: none;
        }

        .question-section.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .question-number {
            font-size: 0.9em;
            color: #a0aec0;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .question-text {
            font-size: 1.3em;
            color: #2d3748;
            margin-bottom: 25px;
            font-weight: 600;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 18px 24px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            font-size: 1em;
            color: #4a5568;
            text-align: left;
        }

        .option:hover {
            border-color: #667eea;
            background: #f7fafc;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-button {
            background: #e2e8f0;
            color: #4a5568;
            border: none;
            padding: 14px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .nav-button:hover:not(:disabled) {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-button.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
        }

        .persona-title {
            font-size: 2em;
            color: #2d3748;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .persona-description {
            font-size: 1.15em;
            color: #4a5568;
            text-align: center;
            line-height: 1.8;
            margin-bottom: 40px;
            padding: 0 20px;
        }

        .com-b-profile {
            background: #f7fafc;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .com-b-title {
            font-size: 1.1em;
            color: #2d3748;
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }

        .dimension {
            margin-bottom: 20px;
        }

        .dimension-label {
            font-size: 0.95em;
            color: #4a5568;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .bar-container {
            width: 100%;
            height: 30px;
            background: #e2e8f0;
            border-radius: 20px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            border-radius: 20px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            color: white;
            font-weight: 600;
            font-size: 0.85em;
        }

        .bar-fill.high {
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
        }

        .bar-fill.medium {
            background: linear-gradient(90deg, #ed8936 0%, #dd6b20 100%);
        }

        .bar-fill.low {
            background: linear-gradient(90deg, #f56565 0%, #e53e3e 100%);
        }

        .quick-action {
            background: #fff5f5;
            border-left: 4px solid #667eea;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .quick-action h3 {
            font-size: 1.2em;
            color: #2d3748;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .quick-action p {
            font-size: 1.05em;
            color: #4a5568;
            line-height: 1.7;
        }

        .email-gate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
        }

        .email-gate h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .email-gate p {
            font-size: 1.05em;
            margin-bottom: 25px;
            opacity: 0.95;
        }

        .email-gate ul {
            list-style-type: none;
            padding: 0;
        }

        .email-gate ul li {
            position: relative;
            padding-left: 25px;
            margin-bottom: 12px;
            text-align: left;
        }

        .email-gate ul li:before {
            content: "→";
            position: absolute;
            left: 0;
            font-weight: bold;
        }

        .email-form {
            display: flex;
            gap: 12px;
            max-width: 500px;
            margin: 0 auto;
        }

        .email-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 50px;
            font-size: 1em;
        }

        .email-submit {
            background: white;
            color: #667eea;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            white-space: nowrap;
        }

        .email-submit:hover {
            transform: scale(1.05);
        }

        .hidden {
            display: none;
        }

        @media (max-width: 600px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 2em;
            }

            .email-form {
                flex-direction: column;
            }

            .email-submit {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Intro Section -->
        <div id="intro-section">
            <div class="header">
                <h1>Why Your AI Tools Aren't Sticking</h1>
                <p class="subtitle">2-minute diagnostic reveals if your blocker is skills, workflow, or trust</p>
            </div>
            
            <div class="intro">
                <p>Your team knows AI could save 10 hours a week. Some people have tried tools. But three months later, everyone's back to the old way. Meanwhile, your competitors are shipping work in half the time.</p>
                <p>We've seen this in 100+ marketing teams. The blocker is predictable, but it's usually not what you think.</p>
                <p>Six questions reveal which of 8 patterns is blocking your team - and the fix that worked for teams like yours.</p>
                <button class="start-button" onclick="startAudit()">Diagnose My Blocker</button>
            </div>
        </div>

        <!-- Questions Section -->
        <div id="questions-section" class="question-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>

            <div id="question-container">
                <!-- Questions will be dynamically inserted here -->
            </div>

            <div class="navigation">
                <button class="nav-button" id="prev-button" onclick="previousQuestion()" disabled>Previous</button>
                <button class="nav-button primary" id="next-button" onclick="nextQuestion()">Next</button>
            </div>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="results-section">
            <h2 class="persona-title" id="persona-headline"></h2>
            
            <div style="background: #fff5f5; padding: 25px; border-radius: 12px; margin-bottom: 30px;">
                <p id="persona-insight" style="font-size: 1.05em; color: #4a5568; line-height: 1.8; white-space: pre-line;"></p>
            </div>

            <div class="com-b-profile">
                <h3 class="com-b-title">What Your Scores Mean</h3>
                <p id="scores-explanation" style="font-size: 1em; color: #4a5568; line-height: 1.7; margin-bottom: 25px; text-align: center;"></p>
                
                <div class="dimension">
                    <div class="dimension-label">Capability (Skills & Knowledge)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="capability-bar"></div>
                    </div>
                </div>

                <div class="dimension">
                    <div class="dimension-label">Opportunity (Workflow & Time)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="opportunity-bar"></div>
                    </div>
                </div>

                <div class="dimension">
                    <div class="dimension-label">Motivation (Belief & Trust)</div>
                    <div class="bar-container">
                        <div class="bar-fill" id="motivation-bar"></div>
                    </div>
                </div>
            </div>

            <div class="quick-action">
                <h3>Your Quick Win</h3>
                <p id="quick-action-text" style="white-space: pre-line;"></p>
            </div>

            <div class="email-gate">
                <h3>Get Your AI Adoption Roadmap (In One Session)</h3>
                <p style="margin-bottom: 20px;">Stop guessing. In one session, we'll build:</p>
                <ul style="text-align: left; max-width: 650px; margin: 0 auto 25px; line-height: 1.8; padding-left: 20px; list-style-type: disc;">
                    <li style="margin-bottom: 12px;"><strong>Your AI-Native Scorecard</strong> – A diagnostic across the 6 dimensions of adoption. You'll finally know why the tools aren't sticking.</li>
                    <li style="margin-bottom: 12px;"><strong>The Unblocker Strategy</strong> – We'll isolate the 3 specific behavioral levers you need to pull to get your team actually using the tech you bought.</li>
                    <li style="margin-bottom: 12px;"><strong>The ROI Calculator</strong> – We'll map your current workflows to identify exactly which metrics will move (and by how much) once AI is installed correctly.</li>
                    <li style="margin-bottom: 12px;"><strong>The Cost of Inaction Report</strong> – A candid assessment of the risks accumulating in your team right now—from burnout to shadow AI—if this isn't fixed.</li>
                    <li style="margin-bottom: 12px;"><strong>Your 30-Day Execution Sprint</strong> – A week-by-week plan to install these habits. No fluff. Just the actions.</li>
                </ul>
                <p style="font-size: 0.95em; opacity: 0.95; margin-bottom: 25px;">The anti-pitch promise: This isn't a sales call in disguise. It's a diagnostic session. You get the roadmap PDF whether we work together or not.</p>
                <button class="start-button" onclick="startDownloadFlow()" style="margin-top: 15px;">Download Your READINESS Report</button>
            </div>
        </div>
    </div>

    <script>
        // Questions data
        const questions = [
            {
                id: 1,
                dimension: 'capability',
                text: "When someone on your team needs to solve a problem with AI, they typically...",
                options: [
                    { text: "Figure it out independently using AI tools", value: 4 },
                    { text: "Ask colleagues who've done something similar", value: 3 },
                    { text: "Search for tutorials but struggle to apply them", value: 2 },
                    { text: "Avoid AI and solve it the old way", value: 1 }
                ]
            },
            {
                id: 2,
                dimension: 'capability',
                text: "Your team's biggest AI knowledge gap is...",
                options: [
                    { text: "We're confident - just need to refine our approach", value: 4 },
                    { text: "Understanding which use cases are worth automating", value: 3 },
                    { text: "How to actually build/prompt AI solutions", value: 2 },
                    { text: "Which AI tools exist and what they do", value: 1 }
                ]
            },
            {
                id: 3,
                dimension: 'opportunity',
                text: "AI tools are currently integrated into your team's core workflows...",
                options: [
                    { text: "Throughout - AI is embedded in how we work", value: 4 },
                    { text: "In specific workflows, but not consistently", value: 3 },
                    { text: "Ad-hoc - individuals use it, but no team process", value: 2 },
                    { text: "Not at all - we're still figuring out where it fits", value: 1 }
                ]
            },
            {
                id: 4,
                dimension: 'opportunity',
                text: "When your team wants to experiment with AI, they have...",
                options: [
                    { text: "Dedicated time and leadership support", value: 4 },
                    { text: "Permission but must find time around other work", value: 3 },
                    { text: "Interest but no clear path to make it happen", value: 2 },
                    { text: "No bandwidth - we're too busy with current work", value: 1 }
                ]
            },
            {
                id: 5,
                dimension: 'motivation',
                text: "Your team's attitude toward AI adoption is...",
                options: [
                    { text: "Strategic priority - we see competitive advantage", value: 4 },
                    { text: "Interested - seems useful but not urgent", value: 3 },
                    { text: "Cautious - we'll adopt when we have to", value: 2 },
                    { text: "Skeptical - unconvinced of the value", value: 1 }
                ]
            },
            {
                id: 6,
                dimension: 'motivation',
                text: "When your team uses AI outputs, they...",
                options: [
                    { text: "Trust them enough to integrate into deliverables", value: 4 },
                    { text: "Use them as starting points but heavily revise", value: 3 },
                    { text: "Review skeptically and often revert to manual work", value: 2 },
                    { text: "Rarely use AI because outputs aren't reliable", value: 1 }
                ]
            }
        ];

        // Persona definitions
        const personas = {
            'high-low-high': {
                name: 'The Proof Seekers',
                headline: "You're a Proof Seeker - And Here's Your Risk",
                insight: "Your team has the skills and the systems, but they're not convinced AI is worth the investment yet. This isn't a capability problem. It's a proof problem. Without concrete evidence that AI delivers better results faster, your team will keep defaulting to methods they trust.\n\nThe danger: While you debate, competitors are building AI-native workflows that create compound advantages. Every month of skepticism widens that gap.",
                scoresExplain: "Your team scores high on Capability (they know how to use AI) and Opportunity (you have tools and time). But Motivation is low. They don't see urgent value in changing how they work.\n\nThis is why your team tried tools but went back to the old way - they're waiting for proof that AI is better than their proven methods.",
                action: "This week: Pick one task your team universally hates (report formatting, campaign setup, competitor research). Assign one person to solve it with AI and measure time saved. Share the before/after numbers at your next team meeting.\n\nWhy this works: Skeptics need proof, not promises. One visible win creates believers.",
                roadmapBenefits: [
                    "The 3 highest-impact use cases for skeptical teams (based on fastest time-to-value)",
                    "How to run proof-of-concept pilots that create believers",
                    "The metrics that convince skeptics AI is worth adopting"
                ],
            },
            'high-high-low': {
                name: 'The Ready But Stuck',
                headline: "You're Ready But Stuck - Your Workflows Are the Problem",
                insight: "Your team wants to adopt AI and knows how to use it. But your workflows, processes, and systems weren't built for AI integration. People try to add AI to existing processes and it feels like extra work, not efficiency.\n\nThis is the most fixable blocker, but only if you redesign workflows, not just add tools.",
                scoresExplain: "High Capability and Motivation show your team is ready. Low Opportunity means your current workflows, approval chains, or processes make AI integration harder than manual work.\n\nThis is why your team tried tools but went back to the old way - AI felt like adding steps, not removing them.",
                action: "This week: Map one core workflow end-to-end (content creation, campaign setup, lead scoring - pick one). Circle every step that requires waiting, manual copying, or repetitive formatting. Those are your AI integration points.\n\nWhy this works: You don't need better tools. You need workflows designed for AI from the start.",
                roadmapBenefits: [
                    "How to redesign one workflow to be AI-native (not AI-added)",
                    "Where to remove approval bottlenecks that block AI adoption",
                    "The 4-week implementation plan for Ready But Stuck teams"
                ],
            },
            'low-high-high': {
                name: 'The Hungry Learners',
                headline: "You're Hungry Learners - Ready to Sprint",
                insight: "Your team is motivated and has time to learn, but lacks confidence in their AI skills. This is the best position to be in. Capability gaps close faster than motivation or workflow gaps.\n\nThe risk: Without structured learning, eager teams waste time on random tutorials instead of building skills that matter for your specific use cases.",
                scoresExplain: "High Motivation and Opportunity show you're ready to invest time. Low Capability means your team needs focused skill-building, not more experimentation.\n\nThis is why your team tried tools but went back to the old way - they wanted to use AI but didn't know where to start or how to build confidence.",
                action: "This week: Pick ONE AI tool that solves your team's biggest daily frustration. Assign 30 minutes/day for 5 days for everyone to practice on real work (not tutorials). Share results Friday.\n\nWhy this works: Eager learners need structure. Daily practice on real tasks builds capability faster than sporadic experimentation.",
                roadmapBenefits: [
                    "Which AI skills to build first (based on your team's role and goals)",
                    "The 30-day practice plan that builds confidence",
                    "How to avoid tutorial paralysis and focus on applicable skills"
                ],
            },
            'medium-medium-low': {
                name: 'The Solo Experimenter',
                headline: "You're Solo Experimenters - Wins Aren't Scaling",
                insight: "Some people on your team are using AI successfully. But there's no process for sharing what works, so everyone's reinventing solutions independently. Individual wins aren't becoming team capabilities.\n\nWithout shared learning systems, you'll stay stuck at 20% adoption forever.",
                scoresExplain: "Medium scores across the board show you have pockets of success but no systematic adoption. The blocker is knowledge sharing, not individual capability.\n\nThis is why your team tried tools but went back to the old way - the people who figured it out kept it to themselves, so everyone else gave up.",
                action: "This week: Create a #ai-wins Slack channel (or email thread). Rule: Every time someone uses AI successfully, they share the tool + prompt + result. No commentary needed. Just visibility.\n\nWhy this works: Solo experimenters need to see each other's successes to build confidence and copy what works.",
                roadmapBenefits: [
                    "How to turn individual wins into team playbooks",
                    "The knowledge-sharing system that scales adoption",
                    "How to identify your AI champions and leverage them effectively"
                ],
            },
            'high-low-medium': {
                name: 'The Hesitant Experts',
                headline: "You're Hesitant Experts - Trust Is Holding You Back",
                insight: "Your team has the skills, but they don't trust AI output quality enough to commit to it. They're waiting for AI to get better before fully adopting, but that strategy has a hidden cost.\n\nEvery month of caution, your competitors build advantages that compound. The gap isn't closing. It's widening.",
                scoresExplain: "High Capability shows your team knows how to use AI. Low Motivation means they're unconvinced it's worth changing their proven workflows. This is a trust problem, not a skills problem.\n\nThis is why your team tried tools but went back to the old way - they don't trust the output quality enough to stake their reputation on it.",
                action: "This week: Document 3 competitors or peer companies using AI in your space (look at their job postings, product announcements, or social content). Make the threat visible to your team.\n\nWhy this works: Cautious teams need external pressure to overcome internal inertia. Competitive threat creates urgency.",
                roadmapBenefits: [
                    "How to build trust through controlled AI experiments",
                    "The competitive intelligence that creates urgency",
                    "Quality control processes that make cautious teams confident"
                ],
            },
            'medium-medium-medium': {
                name: 'The Stuck at Good',
                headline: "You're Stuck at Good - And Here's Why That's Dangerous",
                insight: "Your team is making progress across skills, workflow, and motivation. But without a clear owner and deadline, this momentum will stall in 6-8 weeks. You'll stay 'pretty good at AI' but never become AI-native.\n\nTeams stuck at good become permanently stuck at 50% adoption because 'good enough' becomes the new normal.",
                scoresExplain: "All three dimensions are medium, which means you're building capability but lack the structure to sustain it. You need accountability, not more resources.\n\nThis is why your team tried tools but went back to the old way - everyone's doing a little AI work, but nobody owns making it stick.",
                action: "This week: Pick your highest-impact workflow. Assign one person to own making it AI-native. Give them 3 hours/week for 4 weeks. Set a specific deadline to review results.\n\nWhy this works: Teams stuck at good need accountability to avoid diffusion of responsibility. Ownership converts progress into outcomes.",
                roadmapBenefits: [
                    "Which workflow to make AI-native first (based on impact + feasibility)",
                    "The 4-week sprint structure that creates accountability",
                    "How to avoid the momentum trap teams stuck at good always hit"
                ],
            },
            'high-high-medium': {
                name: 'The Nearly Native',
                headline: "You're Nearly Native - Don't Stop at 80%",
                insight: "Your team has skills and motivation. You're close to AI-native. But some workflows still aren't fully integrated, which creates friction that slows everything down. The final step is ruthlessly eliminating manual handoffs.\n\nTeams at this stage often plateau because 'mostly AI-native' feels good enough. Don't stop here. The last 20% delivers disproportionate value.",
                scoresExplain: "High Capability and Motivation show you're ready. Medium Opportunity means you have pockets of manual work still creating bottlenecks. The last 20% delivers disproportionate value.\n\nThis is why even your team occasionally reverts to old methods - those final manual handoffs still exist and become tempting shortcuts under pressure.",
                action: "This week: Audit your top 5 workflows. Find every point where someone copies data manually, waits for approval, or reformats AI output. Pick the biggest bottleneck and eliminate it.\n\nWhy this works: The final integration gaps create disproportionate friction. Removing them unlocks full AI-native velocity.",
                roadmapBenefits: [
                    "How to identify your remaining manual bottlenecks",
                    "The integration strategy that gets you to 100% AI-native",
                    "How to sustain AI-native operations long-term"
                ],
            },
            'low-low-high': {
                name: 'The Slow Burn',
                headline: "You're on Slow Burn - Here's How to Ignite",
                insight: "Your team has the space to learn (time, resources, support) but lacks both skills and conviction that AI is worth the effort. This combination means AI adoption feels like a distraction from 'real work.'\n\nThe fix: Start small with a tool that solves a universally hated task. One visible win builds both capability and motivation.",
                scoresExplain: "High Opportunity shows you have resources. Low Capability and Motivation mean your team needs proof AI is worth learning. This is a quick-win problem, not a resources problem.\n\nThis is why your team tried tools but went back to the old way - AI felt like extra work with no visible payoff.",
                action: "This week: Pick the task your team complains about most (formatting reports, scheduling posts, data entry). Find one AI tool that handles 80% of it. Have one person test it and share results.\n\nWhy this works: Slow Burn teams need to see AI remove pain before they'll invest time learning it. Start with relief, not ambition.",
                roadmapBenefits: [
                    "The highest-ROI first use case for reluctant teams",
                    "How to build confidence through small, visible wins",
                    "The learning path that converts reluctance into momentum"
                ],
            }
        };

        let currentQuestion = 0;
        let answers = {};

        function startAudit() {
            document.getElementById('intro-section').classList.add('hidden');
            document.getElementById('questions-section').classList.add('active');
            renderQuestion();
            updateProgress();
        }

        function renderQuestion() {
            const question = questions[currentQuestion];
            const container = document.getElementById('question-container');
            
            container.innerHTML = `
                <div class="question-number">Question ${currentQuestion + 1} of ${questions.length}</div>
                <div class="question-text">${question.text}</div>
                <div class="options">
                    ${question.options.map((option, index) => `
                        <div class="option ${answers[question.id] === option.value ? 'selected' : ''}" 
                             onclick="selectOption(${question.id}, ${option.value}, this)">
                            ${option.text}
                        </div>
                    `).join('')}
                </div>
            `;

            // Update navigation buttons
            document.getElementById('prev-button').disabled = currentQuestion === 0;
            document.getElementById('next-button').textContent = currentQuestion === questions.length - 1 ? 'See Results' : 'Next';
        }

        function selectOption(questionId, value, element) {
            answers[questionId] = value;
            
            // Remove selected class from all options
            element.parentElement.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
        }

        function nextQuestion() {
            if (!answers[questions[currentQuestion].id]) {
                alert('Please select an answer before continuing');
                return;
            }

            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
                updateProgress();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }

        function calculateScores() {
            let capability = 0;
            let opportunity = 0;
            let motivation = 0;

            questions.forEach(q => {
                const answer = answers[q.id];
                if (q.dimension === 'capability') capability += answer;
                if (q.dimension === 'opportunity') opportunity += answer;
                if (q.dimension === 'motivation') motivation += answer;
            });

            return { capability, opportunity, motivation };
        }

        function classifyScore(score) {
            if (score >= 6) return 'high';
            if (score >= 4) return 'medium';
            return 'low';
        }

        function getPersona(c, o, m) {
            const pattern = `${c}-${o}-${m}`;
            return personas[pattern] || personas['medium-medium-medium'];
        }

        function showResults() {
            const scores = calculateScores();
            const c = classifyScore(scores.capability);
            const o = classifyScore(scores.opportunity);
            const m = classifyScore(scores.motivation);
            
            const persona = getPersona(c, o, m);

            // Hide questions, show results
            document.getElementById('questions-section').classList.remove('active');
            document.getElementById('results-section').classList.add('active');

            // Update persona info
            document.getElementById('persona-headline').textContent = persona.headline;
            document.getElementById('persona-insight').textContent = persona.insight;
            document.getElementById('scores-explanation').textContent = persona.scoresExplain;
            document.getElementById('quick-action-text').textContent = persona.action;

            // Update COM-B bars
            updateBar('capability', scores.capability, c);
            updateBar('opportunity', scores.opportunity, o);
            updateBar('motivation', scores.motivation, m);
        }

        function updateBar(dimension, score, level) {
            const bar = document.getElementById(`${dimension}-bar`);
            const percentage = (score / 8) * 100;
            
            setTimeout(() => {
                bar.style.width = percentage + '%';
                bar.className = `bar-fill ${level}`;
                bar.textContent = level.toUpperCase();
            }, 300);
        }

        function startDownloadFlow() {
            const scores = calculateScores();
            const c = classifyScore(scores.capability);
            const o = classifyScore(scores.opportunity);
            const m = classifyScore(scores.motivation);
            const persona = getPersona(c, o, m);
            
            // Save results to localStorage for PDF generation after Tally
            const diagnosticData = {
                persona: persona,
                scores: scores,
                classifications: { c, o, m },
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('aiReadinessDiagnostic', JSON.stringify(diagnosticData));
            
            // Open Tally form with hidden fields
            const tallyURL = `https://tally.so/r/ob2QMO?persona=${encodeURIComponent(persona.name)}&capability_score=${scores.capability}&opportunity_score=${scores.opportunity}&motivation_score=${scores.motivation}`;
            
            window.location.href = tallyURL;
        }

        function generatePDF(name, company) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Retrieve saved diagnostic data
            const data = JSON.parse(localStorage.getItem('aiReadinessDiagnostic'));
            if (!data) {
                alert('Diagnostic data not found. Please retake the assessment.');
                return;
            }
            
            const persona = data.persona;
            const scores = data.scores;
            const { c, o, m } = data.classifications;
            const date = new Date().toLocaleDateString('en-GB');
            
            // Colors
            const purple = [102, 126, 234];
            const darkGray = [45, 55, 72];
            const mediumGray = [74, 85, 104];
            
            // PAGE 1: DIAGNOSIS
            
            // Header bar
            doc.setFillColor(...purple);
            doc.rect(0, 0, 210, 15, 'F');
            
            // Header text
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('AI READINESS REPORT', 105, 9, { align: 'center' });
            
            // Subheader
            doc.setFontSize(9);
            doc.setFont(undefined, 'normal');
            doc.text(`Prepared for: ${name}, ${company} | ${date}`, 105, 13, { align: 'center' });
            
            // Reset text color
            doc.setTextColor(...darkGray);
            
            // Divider
            doc.setDrawColor(200, 200, 200);
            doc.line(15, 20, 195, 20);
            
            // Your Pattern
            doc.setFontSize(16);
            doc.setFont(undefined, 'bold');
            doc.text(`YOUR PATTERN: ${persona.name.toUpperCase()}`, 15, 30);
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'bold');
            const headlineLines = doc.splitTextToSize(persona.headline, 180);
            doc.text(headlineLines, 15, 38);
            
            // The Diagnosis
            let yPos = 38 + (headlineLines.length * 6);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('THE DIAGNOSIS:', 15, yPos + 8);
            
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            const insightLines = doc.splitTextToSize(persona.insight, 180);
            doc.text(insightLines, 15, yPos + 15);
            
            // COM-B Profile
            yPos = yPos + 15 + (insightLines.length * 5);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('YOUR COM-B PROFILE:', 15, yPos + 8);
            
            // Draw bars
            yPos = yPos + 15;
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            
            const drawBar = (label, score, classification, y) => {
                doc.text(label, 15, y);
                
                // Bar background
                doc.setFillColor(226, 232, 240);
                doc.rect(70, y - 4, 80, 6, 'F');
                
                // Bar fill
                const fillWidth = (score / 8) * 80;
                const barColor = classification === 'high' ? [72, 187, 120] : 
                                classification === 'medium' ? [237, 137, 54] : [245, 101, 101];
                doc.setFillColor(...barColor);
                doc.rect(70, y - 4, fillWidth, 6, 'F');
                
                // Score text
                doc.text(`${score}/8`, 155, y);
                doc.text(classification.toUpperCase(), 170, y);
            };
            
            drawBar('Capability (Skills & Knowledge)', scores.capability, c, yPos);
            drawBar('Opportunity (Workflow & Time)', scores.opportunity, o, yPos + 10);
            drawBar('Motivation (Belief & Trust)', scores.motivation, m, yPos + 20);
            
            // Why tools didn't stick
            yPos = yPos + 35;
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('WHY THE TOOLS DIDN\'T STICK:', 15, yPos);
            
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            const explainLines = doc.splitTextToSize(persona.scoresExplain, 180);
            doc.text(explainLines, 15, yPos + 6);
            
            // Primary Blocker
            yPos = yPos + 6 + (explainLines.length * 5) + 5;
            const lowestDimension = scores.capability <= scores.opportunity && scores.capability <= scores.motivation ? 'Capability' :
                                   scores.opportunity <= scores.motivation ? 'Opportunity' : 'Motivation';
            doc.setFont(undefined, 'bold');
            doc.text(`PRIMARY BLOCKER: ${lowestDimension}`, 15, yPos);
            
            // PAGE 2: ACTION PLAN
            doc.addPage();
            
            // Header bar
            doc.setFillColor(...purple);
            doc.rect(0, 0, 210, 15, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('YOUR ACTION PLAN', 105, 9, { align: 'center' });
            
            // Reset
            doc.setTextColor(...darkGray);
            doc.setDrawColor(200, 200, 200);
            doc.line(15, 20, 195, 20);
            
            // Start This Week
            yPos = 28;
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('START THIS WEEK:', 15, yPos);
            
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            const actionLines = doc.splitTextToSize(persona.action, 180);
            doc.text(actionLines, 15, yPos + 6);
            
            // What You Get
            yPos = yPos + 6 + (actionLines.length * 5) + 10;
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('WHAT YOU GET IN YOUR ROADMAP SESSION:', 15, yPos);
            
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            yPos = yPos + 7;
            
            const benefits = [
                'AI-Native Scorecard across 6 dimensions',
                'Unblocker Strategy with specific tactics',
                'ROI Calculator mapping your workflows',
                'Cost of Inaction Report for your pattern',
                '30-Day Execution Sprint (week-by-week)'
            ];
            
            benefits.forEach((benefit, index) => {
                doc.text(`• ${benefit}`, 18, yPos + (index * 6));
            });
            
            // Book Session
            yPos = yPos + (benefits.length * 6) + 10;
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('BOOK YOUR SESSION:', 15, yPos);
            
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            doc.setTextColor(102, 126, 234);
            doc.textWithLink('readiness.expandedfuture.com', 15, yPos + 6, {
                url: 'https://calendar.app.google/5j3iBjmE8jN9wqXJ7'
            });
            
            // Anti-Pitch Promise
            doc.setTextColor(...mediumGray);
            yPos = yPos + 15;
            const promiseLines = doc.splitTextToSize('The Anti-Pitch Promise: This is a diagnostic session, not a sales call. You get the roadmap whether we work together or not.', 180);
            doc.text(promiseLines, 15, yPos);
            
            // Footer
            doc.setDrawColor(200, 200, 200);
            doc.line(15, 280, 195, 280);
            doc.setFontSize(9);
            doc.setTextColor(...mediumGray);
            doc.text('Expanded Future | readiness.expandedfuture.com', 105, 287, { align: 'center' });
            
            // Save PDF
            doc.save(`AI-Readiness-Report-${company.replace(/\s+/g, '-')}.pdf`);
            
            // Clear localStorage
            localStorage.removeItem('aiReadinessDiagnostic');
        }

        // Check if returning from Tally with download trigger
        window.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const shouldDownload = urlParams.get('download');
            const name = urlParams.get('name');
            const company = urlParams.get('company');
            
            if (shouldDownload === 'true' && name && company) {
                // Generate and download PDF
                generatePDF(decodeURIComponent(name), decodeURIComponent(company));
                
                // Clean up URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        });
    </script>
</body>
</html>
